---
import Layout from '@/layouts/Layout.astro';
import { buttonVariants } from '@/components/ui/button';
import { Plus, Building2, CheckCircle, XCircle } from 'lucide-react';
import { EmpresasTable } from '@/components/sii/empresas-table';
import { empresasService } from '@/lib/sii-api';

// Obtener empresas de la API
const response = await empresasService.listar();
const empresas = response.success && response.data ? response.data : [];
---

<Layout title="Empresas">
  <Fragment slot="actions">
    <a href="/admin/empresas/nueva" class={buttonVariants()}>
      <Plus class="mr-2 h-4 w-4" /> Nueva Empresa
    </a>
  </Fragment>

  <div class="space-y-4">
    <p class="text-muted-foreground">
      Gestiona las empresas emisoras de documentos tributarios.
    </p>

    <div class="rounded-xl border">
      <EmpresasTable empresas={empresas} client:load />
    </div>
  </div>
</Layout>
